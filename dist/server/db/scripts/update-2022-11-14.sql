/*********** Script Update Date: 2022-11-14  ***********/
-- 0. Update Rest of data first 
DELETE FROM MTitle WHERE [Description] LIKE 'ขุน%'
GO

INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2830, N'พลตำรวจเอกหญิง', N'พล.ต.อ.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2831, N'พลตำรวจเอก หญิง', N'พล.ต.อ.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2832, N'พล.ต.อ. หญิง', N'พล.ต.อ.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2833, N'พลตำรวจโทหญิง', N'พล.ต.ท.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2834, N'พลตำรวจโท หญิง', N'พล.ต.ท.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2835, N'พล.ต.ท. หญิง', N'พล.ต.ท.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2836, N'พลตำรวจตรีหญิง', N'พล.ต.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2837, N'พลตำรวจตรี หญิง', N'พล.ต.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2838, N'พล.ต.ต. หญิง', N'พล.ต.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2840, N'พันตำรวจเอกหญิง', N'พ.ต.อ.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2841, N'พันตำรวจเอก หญิง', N'พ.ต.อ.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2842, N'พ.ต.อ. หญิง', N'พ.ต.อ.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2843, N'พันตำรวจโทหญิง', N'พ.ต.ท.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2844, N'พันตำรวจโท หญิง', N'พ.ต.ท.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2845, N'พ.ต.ท. หญิง', N'พ.ต.ท.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2846, N'พันตำรวจตรีหญิง', N'พ.ต.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2847, N'พันตำรวจตรี หญิง', N'พ.ต.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2848, N'พ.ต.ต. หญิง', N'พ.ต.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2850, N'ร้อยตำรวจเอกหญิง', N'ร.ต.อ.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2851, N'ร้อยตำรวจเอก หญิง', N'ร.ต.อ.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2852, N'ร.ต.อ. หญิง', N'ร.ต.อ.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2853, N'ร้อยตำรวจโทหญิง', N'ร.ต.ท.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2854, N'ร้อยตำรวจโท หญิง', N'ร.ต.ท.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2855, N'ร.ต.ท. หญิง', N'ร.ต.ท.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2856, N'ร้อยตำรวจตรีหญิง', N'ร.ต.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2857, N'ร้อยตำรวจตรี หญิง', N'ร.ต.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2858, N'ร.ต.ต. หญิง', N'ร.ต.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2860, N'ดาบตำรวจหญิง', N'ด.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2861, N'ดาบตำรวจ หญิง', N'ด.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2862, N'ด.ต. หญิง', N'ด.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2863, N'จ่าสิบตำรวจหญิง', N'จ.ส.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2864, N'จ่าสิบตำรวจ หญิง', N'จ.ส.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2865, N'จ.ส.ต. หญิง', N'จ.ส.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2870, N'สิบตำรวจเอกหญิง', N'ส.ต.อ.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2871, N'สิบตำรวจเอก หญิง', N'ส.ต.อ.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2872, N'ส.ต.อ. หญิง', N'ส.ต.อ.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2873, N'สิบตำรวจโทหญิง', N'ส.ต.ท.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2874, N'สิบตำรวจโท หญิง', N'ส.ต.ท.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2875, N'ส.ต.ท. หญิง', N'ส.ต.ท.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2876, N'สิบตำรวจตรีหญิง', N'ส.ต.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2877, N'สิบตำรวจตรี หญิง', N'ส.ต.ต.หญิง', 2)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2878, N'ส.ต.ต. หญิง', N'ส.ต.ต.หญิง', 2)

INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2880, N'ว่าที่พลตำรวจเอกหญิง', N'ว่าที่ พล.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2881, N'ว่าที่ พลตำรวจเอกหญิง', N'ว่าที่ พล.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2882, N'ว่าที่ พลตำรวจ เอกหญิง', N'ว่าที่ พล.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2883, N'ว่าที่ พลตำรวจเอก หญิง', N'ว่าที่ พล.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2884, N'ว่าที่ พล.ต.เอกหญิง', N'ว่าที่ พล.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2885, N'ว่าที่ พล.ต.เอก หญิง', N'ว่าที่ พล.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2886, N'ว่าที่พล.ต.อหญิง', N'ว่าที่ พล.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2887, N'ว่าที่พล.ต.อ หญิง', N'ว่าที่ พล.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2890, N'ว่าที่พลตำรวจโทหญิง', N'ว่าที่ พล.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2891, N'ว่าที่ พลตำรวจโทหญิง', N'ว่าที่ พล.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2892, N'ว่าที่ พลตำรวจ โทหญิง', N'ว่าที่ พล.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2893, N'ว่าที่ พลตำรวจโท หญิง', N'ว่าที่ พล.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2894, N'ว่าที่ พล.ต.โทหญิง', N'ว่าที่ พล.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2895, N'ว่าที่ พล.ต.โท หญิง', N'ว่าที่ พล.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2896, N'ว่าที่พล.ต.ทหญิง', N'ว่าที่ พล.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2897, N'ว่าที่พล.ต.ท หญิง', N'ว่าที่ พล.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2900, N'ว่าที่พลตำรวจตรีหญิง', N'ว่าที่ พล.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2901, N'ว่าที่ พลตำรวจตรีหญิง', N'ว่าที่ พล.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2902, N'ว่าที่ พลตำรวจ ตรีหญิง', N'ว่าที่ พล.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2903, N'ว่าที่ พลตำรวจตรี หญิง', N'ว่าที่ พล.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2904, N'ว่าที่ พล.ต.ตรีหญิง', N'ว่าที่ พล.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2905, N'ว่าที่ พล.ต.ตรี หญิง', N'ว่าที่ พล.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2906, N'ว่าที่พล.ต.ตหญิง', N'ว่าที่ พล.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2907, N'ว่าที่พล.ต.ต หญิง', N'ว่าที่ พล.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2910, N'ว่าที่พลตำรวจจัตวาหญิง', N'ว่าที่ พล.ต.จ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2911, N'ว่าที่ พลตำรวจจัตวาหญิง', N'ว่าที่ พล.ต.จ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2912, N'ว่าที่ พลตำรวจ จัตวาหญิง', N'ว่าที่ พล.ต.จ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2913, N'ว่าที่ พลตำรวจจัตวา หญิง', N'ว่าที่ พล.ต.จ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2914, N'ว่าที่ พล.ต.จัตวาหญิง', N'ว่าที่ พล.ต.จ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2915, N'ว่าที่ พล.ต.จัตวา หญิง', N'ว่าที่ พล.ต.จ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2916, N'ว่าที่พล.ต.จหญิง', N'ว่าที่ พล.ต.จ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2917, N'ว่าที่พล.ต.จ หญิง', N'ว่าที่ พล.ต.จ.หญิง', 1)

INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2920, N'ว่าที่พันตำรวจเอกหญิง', N'ว่าที่ พล.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2921, N'ว่าที่ พันตำรวจเอกหญิง', N'ว่าที่ พ.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2922, N'ว่าที่ พันตำรวจ เอกหญิง', N'ว่าที่ พ.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2923, N'ว่าที่ พันตำรวจเอก หญิง', N'ว่าที่ พ.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2924, N'ว่าที่ พ.ต.เอกหญิง', N'ว่าที่ พ.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2925, N'ว่าที่ พ.ต.เอก หญิง', N'ว่าที่ พ.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2926, N'ว่าที่พัน.ต.อหญิง', N'ว่าที่ พ.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2927, N'ว่าที่พัน.ต.อ หญิง', N'ว่าที่ พ.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2930, N'ว่าที่พันตำรวจโทหญิง', N'ว่าที่ พล.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2931, N'ว่าที่ พันตำรวจโทหญิง', N'ว่าที่ พ.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2932, N'ว่าที่ พันตำรวจ โทหญิง', N'ว่าที่ พ.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2933, N'ว่าที่ พันตำรวจโท หญิง', N'ว่าที่ พ.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2934, N'ว่าที่ พ.ต.โทหญิง', N'ว่าที่ พ.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2935, N'ว่าที่ พ.ต.โท หญิง', N'ว่าที่ พ.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2936, N'ว่าที่พัน.ต.ทหญิง', N'ว่าที่ พ.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2937, N'ว่าที่พัน.ต.ท หญิง', N'ว่าที่ พ.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2940, N'ว่าที่พันตำรวจตรีหญิง', N'ว่าที่ พล.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2941, N'ว่าที่ พันตำรวจตรีหญิง', N'ว่าที่ พ.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2942, N'ว่าที่ พันตำรวจ ตรีหญิง', N'ว่าที่ พ.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2943, N'ว่าที่ พันตำรวจตรี หญิง', N'ว่าที่ พ.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2944, N'ว่าที่ พ.ต.ตรีหญิง', N'ว่าที่ พ.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2945, N'ว่าที่ พ.ต.ตรี หญิง', N'ว่าที่ พ.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2946, N'ว่าที่พัน.ต.ตหญิง', N'ว่าที่ พ.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2947, N'ว่าที่พัน.ต.ต หญิง', N'ว่าที่ พ.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2950, N'พลอากาศเอกหญิง.ดร.', N'พล.อ.อ.หญิง ดร.', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2951, N'พลอากาศเอกหญิง ดร.', N'พล.อ.อ.หญิง ดร.', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2952, N'พล.อ.อ. หญิง ดร.', N'พล.อ.อ.หญิง ดร.', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2953, N'พลอากาศโทหญิง.ดร.', N'พล.อ.ท.หญิง ดร.', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2954, N'พลอากาศโทหญิง ดร.', N'พล.อ.ท.หญิง ดร.', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2955, N'พล.อ.ท. หญิง ดร.', N'พล.อ.ท.หญิง ดร.', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2956, N'พลอากาศตรีหญิง.ดร.', N'พล.อ.ต.หญิง ดร.', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2957, N'พลอากาศตรีหญิง ดร.', N'พล.อ.ต.หญิง ดร.', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2958, N'พล.อ.ต. หญิง ดร.', N'พล.อ.ต.หญิง ดร.', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2960, N'พลอากาศเอกหญิง', N'พล.อ.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2961, N'พลอากาศเอก หญิง', N'พล.อ.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2962, N'พล.อ.อ. หญิง', N'พล.อ.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2963, N'พลอากาศโทหญิง', N'พล.อ.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2964, N'พลอากาศโท หญิง', N'พล.อ.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2965, N'พล.อ.ท. หญิง', N'พล.อ.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2966, N'พลอากาศตรีหญิง', N'พล.อ.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2967, N'พลอากาศตรี หญิง', N'พล.อ.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2968, N'พล.อ.ต. หญิง', N'พล.อ.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2971, N'ว่าที่พันตำรวจเอก หญิง', N'ว่าที่ พ.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2974, N'ว่าที่พัน.ต.อ.หญิง', N'ว่าที่ พ.ต.อ.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2976, N'ว่าที่พันตำรวจโท หญิง', N'ว่าที่ พ.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2979, N'ว่าที่พัน.ต.ท.หญิง', N'ว่าที่ พ.ต.ท.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2981, N'ว่าที่พันตำรวจตรี หญิง', N'ว่าที่ พ.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2984, N'ว่าที่พัน.ต.ต.หญิง', N'ว่าที่ พ.ต.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2985, N'ว่าที่ร้อยตรีหญิง', N'ว่าที่ ร.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2986, N'ว่าที่ร้อยตรี หญิง', N'ว่าที่ ร.ต.หญิง', 1)
INSERT [MTitle] ([TitleId], [Description], [ShortName], [GenderId]) VALUES (2987, N'ว่าที่ ร.ต. หญิง', N'ว่าที่ ร.ต.หญิง', 1)
GO

--- 1. Create MTitle2 (Temporary)

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MTitle2](
	[TitleId] [int] IDENTITY(1,1) NOT NULL,
	[Description] [nvarchar](100) NULL,
	[GenderId] [int] NULL,
 CONSTRAINT [PK_MTitle2] PRIMARY KEY CLUSTERED 
(
	[TitleId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO

CREATE UNIQUE NONCLUSTERED INDEX [IX_MTitle2_Description] ON [dbo].[MTitle2]
(
	[Description] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO

--- 2. MOVE DATE FROM MTitle to MTitle2
INSERT INTO MTitle2 ([Description], GenderId)
(
    SELECT [Description], GenderId FROM MTitle
    UNION
    SELECT DISTINCT ShortName, GenderId FROM MTitle
)
GO

--- 3. DROP MTitle
DROP INDEX IX_MTitle_Description ON MTitle
DROP INDEX IX_MTitle_ShortName ON MTitle
DROP TABLE MTitle
GO

--- 4. CREATE MTitle (same structure as MTitle2)
CREATE TABLE [dbo].[MTitle](
	[TitleId] [int] IDENTITY(1,1) NOT NULL,
	[Description] [nvarchar](100) NULL,
	[GenderId] [int] NULL,
 CONSTRAINT [PK_MTitle] PRIMARY KEY CLUSTERED 
(
	[TitleId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO

CREATE UNIQUE NONCLUSTERED INDEX [IX_MTitle_Description] ON [dbo].[MTitle]
(
	[Description] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO

--- 5. Move data MTitle2 to MTitle
INSERT INTO MTitle([Description], GenderId) SELECT [Description], GenderId FROM MTitle2;
GO

--- 6. DROP MTitle2
DROP INDEX IX_MTitle2_Description ON MTitle2
DROP TABLE MTitle2
GO


/*********** Script Update Date: 2022-11-14  ***********/
/****** Object:  View [dbo].[MTitleView]    Script Date: 11/16/2022 2:21:05 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER VIEW [dbo].[MTitleView]
AS
	SELECT TitleId
         , [Description]
	     , GenderId
		 , LEN([Description]) AS DLen
	  FROM MTitle

GO


/*********** Script Update Date: 2022-11-14  ***********/
/****** Object:  UserDefinedFunction [dbo].[SplitStringT]    Script Date: 11/15/2022 1:25:35 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author: Chumpon Asaneerat
-- Name: SplitStringT.
-- Description:	Split String into substring (Remove empty elements).
-- [== History ==]
-- <2022-08-31> :
--	- Stored Procedure Created.
--
-- [== Example ==]
--
--SELECT dbo.SplitStringT(N'Test  XXX  ', N' ')
--
-- =============================================
ALTER FUNCTION [dbo].[SplitStringT] 
( 
  @string nvarchar(MAX)
, @delim nvarchar(100)
)
RETURNS
@result TABLE 
( 
  [RowId] int  NOT NULL
, [Item] nvarchar(MAX) NOT NULL
, [Index] int NOT NULL 
, [Length] int  NOT NULL
)
AS
BEGIN
DECLARE   @str nvarchar(MAX)
		, @pos int 
		, @length int
		, @max int = LEN(@string)
		, @prv int = 1
		, @rowId int = 1

	SELECT @pos = CHARINDEX(@delim, @string)
	WHILE @pos > 0
	BEGIN
		SELECT @str = SUBSTRING(@string, @prv, @pos - @prv)
		SET @length = @pos - @prv;

		IF (LEN(LTRIM(RTRIM(@str))) > 0)
		BEGIN
			INSERT INTO @result SELECT @rowId
									 , LTRIM(RTRIM(@str))
									 , @prv
									 , @length
			SET @rowId = @rowId + 1 -- SET ROW ID AFTER INSERT
		END

		SELECT @prv = @pos + LEN(@delim)
		     , @pos = CHARINDEX(@delim, @string, @pos + 1)
	END

	SET @length = @max - @prv;
	SET @str = SUBSTRING(@string, @prv, @max)
	IF (LEN(LTRIM(RTRIM(@str))) > 0)
	BEGIN
		INSERT INTO @result SELECT @rowId
								 , LTRIM(RTRIM(@str))
								 , @prv
								 , @length
	END

	RETURN
END

GO


/*********** Script Update Date: 2022-11-14  ***********/
/****** Object:  UserDefinedFunction [dbo].[CountSplitStringT]    Script Date: 11/15/2022 1:01:13 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author: Chumpon Asaneerat
-- Name: SplitStringT.
-- Description:	Count Split String into substring (Remove empty elements).
-- [== History ==]
-- <2022-11-15> :
--	- Stored Procedure Created.
--
-- [== Example ==]
--
--SELECT dbo.CountSplitStringT(N'Test  XXX  ', N' ')
--
-- =============================================
CREATE FUNCTION [dbo].[CountSplitStringT] 
( 
  @string nvarchar(MAX)
, @delim nvarchar(100)
)
RETURNS int
AS
BEGIN
DECLARE @result int;
	SELECT @result = COUNT(*) FROM SplitStringT(@string, @delim)
	RETURN @result
END

GO



/*********** Script Update Date: 2022-11-14  ***********/
DROP PROCEDURE Parse_FullName_Lv5
GO

DROP PROCEDURE Parse_FullName_Lv4
GO

DROP PROCEDURE Parse_FullName_Lv3
GO

DROP PROCEDURE Parse_FullName_Lv2
GO

DROP PROCEDURE Parse_FullName_Lv1
GO

DROP FUNCTION dbo.CountSplitStringT
GO


/*********** Script Update Date: 2022-11-14  ***********/
/****** Object:  StoredProcedure [dbo].[Parse_FullName]    Script Date: 11/14/2022 9:02:01 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author: Chumpon Asaneerat
-- Description:	Extract Prefix, FirstName, LastName from FullName
-- [== History ==]
-- <2022-11-15> :
--	- Stored Procedure Created.
-- <2022-11-16> :
--	- Recheck after change MTitle structure.
--
-- [== Example ==]
--
-- =============================================
CREATE PROCEDURE [dbo].[Parse_FullName] (
  @fullName nvarchar(MAX)
, @prefix nvarchar(MAX) = NULL out
, @firstName nvarchar(MAX) = NULL out
, @lastName nvarchar(MAX) = NULL out
, @errNum as int = 0 out
, @errMsg as nvarchar(MAX) = N'' out)
AS
BEGIN
DECLARE @sFullName nvarchar(MAX);
DECLARE @deli nvarchar(20) = N' ';
DECLARE @isRemove int; -- 0: Not Removed, 1: Removed
DECLARE @el nvarchar(MAX) = NULL;
DECLARE @sTest nvarchar(MAX);
DECLARE @sRemain nvarchar(MAX); -- Remain Text
DECLARE @fullTitle nvarchar(MAX);
DECLARE @matchTitle nvarchar(MAX);
	BEGIN TRY
		SET @prefix = NULL
		SET @firstName = NULL
		SET @lastName = NULL

		-- CHECK PARAMETERS
		IF (@fullName IS NULL OR LEN(@fullName) = 0)
		BEGIN
			SET @errNum = 100;
			SET @errMsg = N'Parameter(s) is null.';
		END

		SET @sFullName = REPLACE(@fullName, N' ', N'') -- FullName that remove all spaces

		SELECT TOP 1 
		       @fullTitle = [Description]
			 , @matchTitle = REPLACE([Description], N' ', N'')
		  FROM MTitleView
		 WHERE @sFullName LIKE REPLACE([Description], N' ', N'') + N'%'
		 ORDER BY DLen DESC

		IF (@fullTitle IS NOT NULL)
		BEGIN
			SET @prefix = @fullTitle
			SET @isRemove = 0
			SET @sTest = N''
		END

		DECLARE SPLIT_STR_CURSOR CURSOR 
		  LOCAL FORWARD_ONLY READ_ONLY FAST_FORWARD 
		FOR  
		  SELECT Item FROM dbo.SplitStringT(@fullName, @deli)

		OPEN SPLIT_STR_CURSOR  
		-- FETCH FIRST
		FETCH NEXT FROM SPLIT_STR_CURSOR INTO @el

		WHILE @@FETCH_STATUS = 0  
		BEGIN
			IF ((@matchTitle IS NOT NULL) AND (@isRemove = 0))
			BEGIN
				-- @matchTitle is Title that remove all spaces.
				-- and @sTest also remove all spaces.
				IF (@sTest IS NULL) SET @sTest = N''
				SET @sTest = LTRIM(RTRIM(@sTest + @el))

				IF (@sTest LIKE @matchTitle + N'%')
				BEGIN
					SET @sRemain = REPLACE(@sTest, @matchTitle, N'')
					IF (LEN(@sRemain) > 0) SET @firstName = @sRemain
					SET @isRemove = 1 -- MARK AS REMOVED
				END
			END
			ELSE
			BEGIN
				-- PREFIX NOT FOUND -> FIND FIRST NAME
				IF (@firstName IS NULL)
				BEGIN
					-- FIRST NAME NOT FOUND SO USER CURRENT TEST VARIABLE
					SET @firstName = @el
				END
				ELSE
				BEGIN
					-- FIRST NAME FOUND THE REMAIN TEXT IS LAST NAME
					IF (@lastName IS NULL) SET @lastName = N''
					SET @lastName = LTRIM(RTRIM(@lastName + ' ' + @el))
				END
			END
			-- FETCH NEXT
			FETCH NEXT FROM SPLIT_STR_CURSOR INTO @el
		END

		CLOSE SPLIT_STR_CURSOR  
		DEALLOCATE SPLIT_STR_CURSOR 	

		SET @errNum = 0;
		SET @errMsg = N'Success';
	END TRY
	BEGIN CATCH
		SET @errNum = ERROR_NUMBER();
		SET @errMsg = ERROR_MESSAGE();
	END CATCH
END

GO


/*********** Script Update Date: 2022-11-14  ***********/
/****** Object:  StoredProcedure [dbo].[SaveMTitle]    Script Date: 11/16/2022 2:20:20 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author: Chumpon Asaneerat
-- Description:	SaveMTitle
-- [== History ==]
-- <2022-08-20> :
--	- Stored Procedure Created.
-- <2022-11-15> :
--	- Update Stored Procedure due to change PK to auto identity.
--
-- [== Example ==]
--
--exec SaveMTitle N'นางสาว1', 2;
-- =============================================
ALTER PROCEDURE [dbo].[SaveMTitle] (
  @Description nvarchar(100)
, @GenderId int = 0
, @TitleId int out
, @errNum as int = 0 out
, @errMsg as nvarchar(MAX) = N'' out)
AS
BEGIN
	BEGIN TRY
		IF ((@TitleId IS NULL)
            OR
            NOT EXISTS 
			(
				SELECT * 
				  FROM MTitle
				 WHERE TitleId = @TitleId
			)
		   )
		BEGIN
			INSERT INTO MTitle
			(
				  [Description]
				, GenderId
			)
			VALUES
			(
				  @Description
				, @GenderId
			);
		    -- Get New ID.
            SELECT @TitleId = @@IDENTITY
		END
		ELSE
		BEGIN
			UPDATE MTitle
			   SET [Description] = @Description
				 , GenderId = @GenderId
			 WHERE TitleId = @TitleId
		END
		-- Update Error Status/Message
		SET @errNum = 0;
		SET @errMsg = 'Success';
	END TRY
	BEGIN CATCH
		SET @errNum = ERROR_NUMBER();
		SET @errMsg = ERROR_MESSAGE();
	END CATCH
END

GO


/*********** Script Update Date: 2022-11-14  ***********/
/****** Object:  StoredProcedure [dbo].[GetMTitles]    Script Date: 11/16/2022 2:19:50 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author: Chumpon Asaneerat
-- Description:	GetMTitles
-- [== History ==]
-- <2022-08-20> :
--	- Stored Procedure Created.
--
-- [== Example ==]
--
-- EXEC GetMTitles NULL, NULL    -- Gets all
-- EXEC GetMTitles N'นาง', NULL  -- Search all that Description contains 'นาง'
-- EXEC GetMTitles NULL, 1       -- Search all that gender is male (0 - None, 1 - Male, 2 - Female)
-- =============================================
ALTER PROCEDURE [dbo].[GetMTitles]
(
  @description nvarchar(100) = NULL
, @genderId int = NULL
)
AS
BEGIN
	SELECT A.TitleId
         , A.[Description]
	     , B.[Description] AS GenderName
	     , A.GenderId
	     , A.DLen
	  FROM MTitleView A, MGender B
	 WHERE A.GenderId = B.GenderId
	   AND UPPER(LTRIM(RTRIM(A.[Description]))) LIKE '%' + UPPER(LTRIM(RTRIM(COALESCE(@description, A.[Description])))) + '%'
	   AND A.GenderId = COALESCE(@genderId, A.GenderId)
	 ORDER BY A.DLen DESC
			, A.[Description]
END

GO

